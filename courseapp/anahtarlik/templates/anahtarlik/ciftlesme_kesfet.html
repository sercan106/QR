{% extends 'ana.html' %}
{% block content %}
<div class="container py-4">
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h4>Çiftleşme Keşfet</h4>
    {% if referans %}
      <a class="btn btn-sm btn-outline-secondary" href="{% url 'ciftlesme_profil' referans.id %}">Profilimi Düzenle</a>
    {% endif %}
  </div>

  {% if not referans %}
    <div class="alert alert-info">Keşfet'i özelleştirmek için önce hayvanlarınızdan biri için çiftleşme profili oluşturun.</div>
  {% endif %}

  <div class="row g-3">
  {% for p in kandidatlar %}
    <div class="col-md-4">
      <div class="card h-100">
        {% if p.foto1 %}<img class="card-img-top" src="{{ p.foto1.url }}" alt="{{ p.evcil_hayvan.ad }}">{% endif %}
        <div class="card-body">
          <h5 class="card-title">{{ p.evcil_hayvan.ad }} ({{ p.evcil_hayvan.get_cinsiyet_display }})</h5>
          <div class="mb-2 text-muted">{{ p.ilce }}, {{ p.il }}</div>
          <div>Irk: {{ p.evcil_hayvan.cins }}</div>
          <div>Ebat: {{ p.get_ebat_display }}</div>
          <div class="small mt-2">{{ p.notlar|default:""|truncatechars:120 }}</div>
        </div>
        <div class="card-footer bg-white border-0">
          <form method="post" action="{% url 'ciftlesme_istek_gonder' p.evcil_hayvan.id %}">
            {% csrf_token %}
            <div class="input-group">
              <input type="text" name="mesaj" class="form-control" placeholder="Kısa mesaj (opsiyonel)">
              <button class="btn btn-primary" type="submit">İstek Gönder</button>
            </div>
          </form>
        </div>
      </div>
    </div>
  {% empty %}
    <div class="col-12"><div class="alert alert-secondary">Gösterilecek uygun profil bulunamadı.</div></div>
  {% endfor %}
  </div>

  <div class="mt-3">
    <a class="btn btn-outline-primary" href="{% url 'ciftlesme_istekler' %}">İsteklerim</a>
  </div>
  
</div>
{% endblock %}

